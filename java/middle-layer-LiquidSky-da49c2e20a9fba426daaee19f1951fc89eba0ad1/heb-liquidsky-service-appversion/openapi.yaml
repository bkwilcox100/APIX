# deployment steps:
# 1. deploy the Open API spec using:
#      gcloud service-management deploy target/openapi.yaml
# 2. the output of the above command will include something like the following:
#    Service Configuration [config_id] uploaded for service [name]
# 3. update the appengine.app.modules.appversion.endpoints.config.id
#    environment property with the config_id value from step #2.
# 4. deploy the full application using "mvn appengine:deploy"
# 5. callers can generate API keys (passed as "key=API_KEY") using
#    https://console.cloud.google.com/apis/credentials

swagger: "2.0"
info:
  title: "HEB Liquid Sky App Version Endpoints"
  description: "HEB e-commerce app version endpoints"
  version: "1.0.0"
# the domain of the service
host: appversionservice-dot-${appengine.app.id}.appspot.com

# allow cross-domain ajax requests
# see https://cloud.google.com/endpoints/docs/release-notes
x-google-endpoints:
  - name: appversionservice-dot-${appengine.app.id}.appspot.com
    allowCors: true
consumes:
  - application/json
produces:
  - application/json
schemes:
  - https
  
paths:
  /appversion/v1/appversion:
    get:
      operationId: readLegacyAppVersion
      parameters: []
      responses:
        200:
          description: A successful response
          schema:
            $ref: '#/definitions/JsonMap'
            
  /appversion/v1/appproperties/{appid}:
    get:
      operationId: readAppPropertiesResource
      parameters:
        - name: appid
          in: path
          required: true
          type: string
      responses:
        200:
          description: A successful response
          schema:
            $ref: '#/definitions/AppProperties'

# This section requires all requests to any path to require an API key.
security:
- api_key: []
securityDefinitions:
  # This section configures basic authentication with an API key.
  api_key:
    type: apiKey
    name: key
    in: query
# defintions are shared object types used in requests/responses
definitions:
  JsonMap:
    type: object
  AppVersion:
    properties:
      osName:
        type: string
      osVersion:
        type: string
  AppProperties:
    properties:
      appId:
        type: string
      appVersions:
        type: array
        items:
          $ref: '#/definitions/AppVersion'
      description:
        type: string
